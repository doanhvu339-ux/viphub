-- Khởi tạo settings
if not getgenv().BaconSettings then
    getgenv().BaconSettings = {
        SpeedToggle=false, InfJump=false, Noclip=false,
        HitboxAll=false, HitboxTeam=false,
        ESPAll=false, ESPTeam=false,
        Speed=100, HitboxSize=20
    }
end
local settings = getgenv().BaconSettings

local player = game.Players.LocalPlayer
local uis = game:GetService("UserInputService")
local rs = game:GetService("RunService")

-- GUI chính
local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
ScreenGui.Name = "BaconPremium"

-- Icon bật tắt menu
local ToggleButton = Instance.new("ImageButton", ScreenGui)
ToggleButton.Size = UDim2.new(0,50,0,50)
ToggleButton.Position = UDim2.new(0,20,0,200)
ToggleButton.Image = "rbxassetid://116361389844239"
ToggleButton.BackgroundTransparency = 1
ToggleButton.Active = true
ToggleButton.Draggable = true

-- Main Frame
local MainFrame = Instance.new("Frame", ScreenGui)
MainFrame.Size = UDim2.new(0,420,0,320)
MainFrame.Position = UDim2.new(0.5,-210,0.5,-160)
MainFrame.BackgroundColor3 = Color3.fromRGB(255,255,255)
MainFrame.Active = true
MainFrame.Draggable = true
Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0,12)

ToggleButton.MouseButton1Click:Connect(function()
    MainFrame.Visible = not MainFrame.Visible
end)

-- Tab bar
local TabBar = Instance.new("Frame", MainFrame)
TabBar.Size = UDim2.new(1,0,0,35)
TabBar.BackgroundColor3 = Color3.fromRGB(200,200,200)
Instance.new("UICorner", TabBar).CornerRadius = UDim.new(0,8)

local Tabs = {}
local function createTab(name)
    local tab = Instance.new("Frame", MainFrame)
    tab.Size = UDim2.new(1,0,1,-35)
    tab.Position = UDim2.new(0,0,0,35)
    tab.BackgroundTransparency = 1
    tab.Visible = false
    Tabs[name] = tab
end

createTab("Main")
createTab("Vision")
createTab("Script")
createTab("Setting")

local function showTab(name)
    for n,f in pairs(Tabs) do
        f.Visible = (n == name)
    end
end

local function addTabButton(name,x)
    local btn = Instance.new("TextButton", TabBar)
    btn.Size = UDim2.new(0,100,1,0)
    btn.Position = UDim2.new(0,x,0,0)
    btn.Text = name
    btn.BackgroundColor3 = Color3.fromRGB(220,220,220)
    btn.TextColor3 = Color3.fromRGB(0,0,0)
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0,8)
    btn.MouseButton1Click:Connect(function()
        showTab(name)
    end)
end

addTabButton("Main",0)
addTabButton("Vision",100)
addTabButton("Script",200)
addTabButton("Setting",300)
showTab("Main")

-- Toggle helper
local function createToggleButton(parent,text,y,key,callback)
    local btn = Instance.new("TextButton", parent)
    btn.Size = UDim2.new(0,200,0,40)
    btn.Position = UDim2.new(0,20,0,y)
    btn.BackgroundColor3 = Color3.fromRGB(220,220,220)
    btn.TextColor3 = Color3.fromRGB(0,0,0)
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0,10)

    local function refresh()
        btn.Text = text.." : "..(settings[key] and "ON" or "OFF")
    end
    refresh()

    btn.MouseButton1Click:Connect(function()
        settings[key] = not settings[key]
        refresh()
        if callback then callback(settings[key]) end
    end)
end

-- TAB MAIN
createToggleButton(Tabs.Main,"Speed",20,"SpeedToggle",function(on)
    if on then
        getgenv().SpeedConn = rs.Stepped:Connect(function()
            if player.Character and player.Character:FindFirstChild("Humanoid") then
                player.Character.Humanoid.WalkSpeed = settings.Speed
            end
        end)
    else
        if getgenv().SpeedConn then getgenv().SpeedConn:Disconnect() end
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            player.Character.Humanoid.WalkSpeed = 16
        end
    end
end)

createToggleButton(Tabs.Main,"Inf Jump",70,"InfJump",function(on)
    if on then
        getgenv().InfJumpConn = uis.JumpRequest:Connect(function()
            if player.Character and player.Character:FindFirstChildOfClass("Humanoid") then
                player.Character:FindFirstChildOfClass("Humanoid"):ChangeState(Enum.HumanoidStateType.Jumping)
            end
        end)
    else
        if getgenv().InfJumpConn then getgenv().InfJumpConn:Disconnect() end
    end
end)

createToggleButton(Tabs.Main,"Noclip",120,"Noclip",function(on)
    if on then
        getgenv().NoclipConn = rs.Stepped:Connect(function()
            if player.Character then
                for _,v in pairs(player.Character:GetDescendants()) do
                    if v:IsA("BasePart") then
                        v.CanCollide = false
                    end
                end
            end
        end)
    else
        if getgenv().NoclipConn then getgenv().NoclipConn:Disconnect() end
    end
end)

-- TAB SCRIPT
local function addScriptButton(name,y,url)
    local btn = Instance.new("TextButton", Tabs.Script)
    btn.Size = UDim2.new(0,200,0,40)
    btn.Position = UDim2.new(0,20,0,y)
    btn.Text = name
    btn.BackgroundColor3 = Color3.fromRGB(220,220,220)
    btn.TextColor3 = Color3.fromRGB(0,0,0)
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0,10)
    btn.MouseButton1Click:Connect(function()
        loadstring(game:HttpGet(url))()
    end)
end

addScriptButton("FlyGui",20,"https://raw.githubusercontent.com/XNEOFF/FlyGuiV3/main/FlyGuiV3.txt")
addScriptButton("Aimbot",70,"https://raw.githubusercontent.com/doanhvu339-ux/viphub/refs/heads/main/Aimbot")
addScriptButton("Infinite Yield",120,"https://rawscripts.net/raw/Infinite-Yield_500")
addScriptButton("Sea In VipHub",170,"https://raw.githubusercontent.com/doanhvu339-ux/viphub/refs/heads/main/sea%20in%20viphub")
addScriptButton("Giant Smash",220,"https://raw.githubusercontent.com/gumanba/Scripts/main/GiantSmash")

-- TAB SETTING
local speedBox = Instance.new("TextBox", Tabs.Setting)
speedBox.Size = UDim2.new(0,150,0,40)
speedBox.Position = UDim2.new(0,20,0,20)
speedBox.Text = tostring(settings.Speed)
speedBox.PlaceholderText = "Speed"
speedBox.FocusLost:Connect(function()
    local v = tonumber(speedBox.Text)
    if v then settings.Speed = v end
end)
